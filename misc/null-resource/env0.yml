deploy:
  steps:
    terraformPlan:
      after:
        - |
          if grep -q "No changes. Your infrastructure matches the configuration." env0_tf_plan.json; then
            echo "No changes detected; skipping apply step."
            exit 0
          fi
    terraformApply:
      before:
        - |
          if grep -q "No changes. Your infrastructure matches the configuration." env0_tf_plan.json; then
            echo "Skipping apply as there are no infrastructure changes."
            exit 0
          fi
